<% extend CommonHelper %>
<div class="cart-content">
    <!-- 判斷購物車是否為空 -->
  <% if current_cart.blank? %>
    <div class="cart-empty">
      <h4>
        <%= fa_icon("shopping-cart lg", text: "購物車目前是空的唷~") %>        
      </h4>
      <%= link_to "BACK TO SHOPPING", products_path, class: "btn" %>
    </div>
  <% else %>
     <!-- simple form -->
    <%= simple_form_for current_cart , url:operations_cart_path(current_cart), method: :patch, remote: true do |f| %>
    <%= f.input_field current_cart.cart_items.count.to_s, name: "cart-items-count", value: current_cart.cart_items.count ,id: "cart-items-count" ,type: "hidden" %>
        <div class="table-responsive">
        <table class="table table-shopping">
          <thead>
            <tr>
              <!-- 全選 -->
              <th>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" class="cart-select-all"/>
                  </label>
                </div>
              </th>
              <th class="products-info">商品資訊</th>
              <th class="text-center">尺寸/數量</th>
              <th class="text-right">Price</th>
              <th class="text-right">Amount</th>
              <th>刪除</th>
            </tr>
          </thead>
          <tbody>
            <!-- 使用each_with_index方法，给每个课程加上序号，用序号组成id，控制js -->
            <% @cart_items.each_with_index do |item, index| %>
              <%= render "carts/cart_item", f: f, item: item, index: index %>
            <% end %>
            <!-- 删除选中课程和总价 -->
            <tr>
              <td>
                <div class="checkbox">
                  <label>
                    <input type="checkbox" class="cart-select-all"/>
                  </label>
                </div>
              </td>
              <td colspan="3">
                <small>已选择<span class="text-info" id="items-count">0</span>门课程</small>
                <button class="cart-btn-delete-all-fake btn btn-raised btn-white" data-toggle="modal" data-target="#confirm-dialog" onclick="confirmRemoveCartItems()">
                  删除选中的课程
                </button>
                <%= f.button :submit, value: true, name: "delete_items", class: "invisible", id: "cart-btn-delete-all" %>
              </td>
              <td class="td-total">
                Total
              </td>
              <td colspan="1" class="td-price">
                <small class="text-info">¥</small>
                <span class="text-info" id="total-price">
           
                </span>
              </td>
              <td></td>
            </tr>
            <!-- 结算按钮 -->
            <tr>
              <td colspan="5"></td>
              <td colspan="2" class="text-center">
                <%= f.button :submit, name: "checkout", value: true, class: "btn-checkout btn btn-raised btn-info btn-round" do %>
                去结算
                <i class="material-icons">keyboard_arrow_right</i>
                <% end %>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    <% end %>
  <% end %>
</div>